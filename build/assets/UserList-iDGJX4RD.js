import{M as S,r as o,K as h,j as e,u as A}from"./index-cOqvBBIr.js";import{A as w}from"./AdaptableCard-BVmYyrG9.js";import{A as U}from"./index-C8lJW4Vi.js";import{B as T}from"./Card-DIGZvD7G.js";import{D as k}from"./DataTable-CPwywcbC.js";import{s as E,t as D,u as I}from"./proxy-CuIDo5Hh.js";import{u as B}from"./useThemeClass-CybD-6cM.js";import{u as K}from"./useQuery-DfbZlmc7.js";import{d as L}from"./debounce-ENV5vHzm.js";import{I as R}from"./hoist-non-react-statics.cjs-B9oDFgJF.js";import{b as $}from"./UserService-CbOW4lHp.js";import{B as H}from"./Button-DwOByDJ2.js";import"./toString-R3Kz-oVC.js";import"./Views-CoZ6zsbe.js";import"./index-CN4Vsls-.js";import"./index-CBL9JDNu.js";import"./_getPrototype-DsJNHg3O.js";function M(n){return S({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"path",attr:{d:"M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"},child:[]},{tag:"circle",attr:{cx:"12",cy:"7",r:"4"},child:[]}]})(n)}const g={super_admin:{label:"Super Admin",dotClass:"bg-purple-500",textClass:"text-purple-500"},admin:{label:"Admin",dotClass:"bg-blue-500",textClass:"text-blue-500"},user:{label:"User",dotClass:"bg-gray-500",textClass:"text-gray-500"}},P=()=>{var p,x;const n=o.useRef(null),r=h(),[c,f]=o.useState(""),[i,d]=o.useState({page:1,limit:10}),[m,j]=o.useState(null);o.useEffect(()=>{const s=localStorage.getItem("user");if(s)try{j(JSON.parse(s))}catch(a){console.error("Error parsing user data:",a)}},[]);const{data:l,isLoading:b,error:u}=K({queryKey:["users",i,c],queryFn:()=>$({page:i.page,limit:i.limit,search:c})}),C=o.useMemo(()=>L(s=>{f(s),d(a=>({...a,page:1}))},500),[]),v=o.useMemo(()=>[{header:"Username",accessorKey:"username",cell:s=>e.jsxs("div",{className:"flex items-center",children:[e.jsx(U,{icon:e.jsx(M,{}),alt:s.row.original.username}),e.jsx("span",{className:"ml-2 font-semibold",children:s.row.original.username})]})},{header:"Role",accessorKey:"role",cell:s=>{const a=s.row.original.role,t=g[a]||g.user;return e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(T,{className:t.dotClass}),e.jsx("span",{className:`font-semibold ${t.textClass}`,children:t.label})]})}},{header:"Created At",accessorKey:"createdAt",cell:s=>e.jsx("span",{children:new Date(s.row.original.createdAt).toLocaleDateString()})},{header:"Actions",id:"action",cell:s=>{const{textTheme:a}=B(),t=s.row.original,N=t.role==="super_admin",y=(m==null?void 0:m.role)==="super_admin";return e.jsxs("div",{className:"flex justify-end text-lg",children:[e.jsx("span",{className:`cursor-pointer p-2 hover:${a}`,onClick:()=>r(`/users/view/${t.id}`),children:e.jsx(E,{})}),(!N||y)&&e.jsx("span",{className:`cursor-pointer p-2 hover:${a}`,onClick:()=>r(`/users/edit/${t.id}`),children:e.jsx(D,{})})]})}}],[r,m]);return u?e.jsx("div",{className:"flex items-center justify-center h-full",children:e.jsxs("span",{className:"text-red-500",children:["Error: ",u.message]})}):e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"mb-4",children:e.jsx(R,{placeholder:"Search users...",onChange:s=>C(s.target.value),className:"max-w-md"})}),e.jsx(k,{ref:n,columns:v,data:((p=l==null?void 0:l.data)==null?void 0:p.data)||[],loading:b,pagingData:{total:((x=l==null?void 0:l.data)==null?void 0:x.total)||0,pageIndex:i.page,pageSize:i.limit},onPaginationChange:s=>d(a=>({...a,page:s})),onSelectChange:s=>d({page:1,limit:s})})]})},_=()=>{const n=h(),{user:r}=A(c=>c.auth);return(r==null?void 0:r.role)==="super_admin"||(r==null||r.role),e.jsx(H,{size:"sm",variant:"solid",icon:e.jsx(I,{}),onClick:()=>n("/users/create"),children:"Add User"})},oe=()=>e.jsxs(w,{className:"h-full",bodyClass:"h-full",children:[e.jsxs("div",{className:"lg:flex items-center justify-between mb-4",children:[e.jsx("h3",{className:"mb-4 lg:mb-0",children:"Users"}),e.jsx(_,{})]}),e.jsx(P,{})]});export{oe as default};
