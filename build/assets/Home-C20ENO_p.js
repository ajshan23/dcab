import{r as g,h as k,j as s,J as E,K as I}from"./index-cOqvBBIr.js";import{C as P,B as _}from"./Card-DIGZvD7G.js";import{P as R}from"./Progress-CRnRERH5.js";import{a as A,b as L,c as X,d as Y,A as z,C as J}from"./chart.config-CfHsf3bG.js";import{B as V}from"./Button-DwOByDJ2.js";import{C as q}from"./ClipLoader-Dev_y_P4.js";import"./index-Chjiymov.js";const C=["line","bar","area"],B=e=>{const{series:n=[],width:t="100%",height:a=300,xAxis:r,customOptions:i,type:o="line",direction:c,donutTitle:h,donutText:d,className:y,...b}=e,u=g.useRef(null),f=g.useMemo(()=>{switch(o){case"line":return A;case"bar":return Y;case"area":return X;case"donut":return L;default:return A}},[o]);let l=JSON.parse(JSON.stringify(f));const m=window.innerWidth<768,D=g.useCallback(()=>{if(u.current){const p=u.current.querySelectorAll("div.apexcharts-legend")[0];c===k&&(p.style.right="auto",p.style.left="0"),m&&(p.style.position="relative",p.style.top="0",p.style.justifyContent="start",p.style.padding="0")}},[c,m]);return g.useEffect(()=>{C.includes(o)&&D()},[o,D]),C.includes(o)&&(l.xaxis.categories=r),i&&(l={...l,...i}),o==="donut"&&(h&&(l.plotOptions.pie.donut.labels.total.label=h),d&&(l.plotOptions.pie.donut.labels.total.formatter=()=>d)),s.jsx("div",{ref:u,style:c===k?{direction:"ltr"}:{},className:"chartRef",children:s.jsx(z,{options:l,type:o,series:n,width:t,height:a,className:y,...b})})},M=43200,O=1440,F=Symbol.for("constructDateFrom");function S(e,n){return typeof e=="function"?e(n):e&&typeof e=="object"&&F in e?e[F](n):e instanceof Date?new e.constructor(n):new Date(n)}function x(e,n){return S(e,e)}let H={};function Q(){return H}function T(e){const n=x(e),t=new Date(Date.UTC(n.getFullYear(),n.getMonth(),n.getDate(),n.getHours(),n.getMinutes(),n.getSeconds(),n.getMilliseconds()));return t.setUTCFullYear(n.getFullYear()),+e-+t}function W(e,...n){const t=S.bind(null,n.find(a=>typeof a=="object"));return n.map(t)}function j(e,n){const t=+x(e)-+x(n);return t<0?-1:t>0?1:t}function U(e){return S(e,Date.now())}function K(e,n,t){const[a,r]=W(t==null?void 0:t.in,e,n),i=a.getFullYear()-r.getFullYear(),o=a.getMonth()-r.getMonth();return i*12+o}function G(e){return n=>{const t=Math.trunc,a=t(n);return a===0?0:a}}function $(e,n){return+x(e)-+x(n)}function Z(e,n){const t=x(e);return t.setHours(23,59,59,999),t}function ee(e,n){const t=x(e),a=t.getMonth();return t.setFullYear(t.getFullYear(),a+1,0),t.setHours(23,59,59,999),t}function te(e,n){const t=x(e);return+Z(t)==+ee(t)}function ne(e,n,t){const[a,r,i]=W(t==null?void 0:t.in,e,e,n),o=j(r,i),c=Math.abs(K(r,i));if(c<1)return 0;r.getMonth()===1&&r.getDate()>27&&r.setDate(30),r.setMonth(r.getMonth()-o*c);let h=j(r,i)===-o;te(a)&&c===1&&j(a,i)===1&&(h=!1);const d=o*(c-+h);return d===0?0:d}function ae(e,n,t){const a=$(e,n)/1e3;return G()(a)}const re={lessThanXSeconds:{one:"less than a second",other:"less than {{count}} seconds"},xSeconds:{one:"1 second",other:"{{count}} seconds"},halfAMinute:"half a minute",lessThanXMinutes:{one:"less than a minute",other:"less than {{count}} minutes"},xMinutes:{one:"1 minute",other:"{{count}} minutes"},aboutXHours:{one:"about 1 hour",other:"about {{count}} hours"},xHours:{one:"1 hour",other:"{{count}} hours"},xDays:{one:"1 day",other:"{{count}} days"},aboutXWeeks:{one:"about 1 week",other:"about {{count}} weeks"},xWeeks:{one:"1 week",other:"{{count}} weeks"},aboutXMonths:{one:"about 1 month",other:"about {{count}} months"},xMonths:{one:"1 month",other:"{{count}} months"},aboutXYears:{one:"about 1 year",other:"about {{count}} years"},xYears:{one:"1 year",other:"{{count}} years"},overXYears:{one:"over 1 year",other:"over {{count}} years"},almostXYears:{one:"almost 1 year",other:"almost {{count}} years"}},se=(e,n,t)=>{let a;const r=re[e];return typeof r=="string"?a=r:n===1?a=r.one:a=r.other.replace("{{count}}",n.toString()),t!=null&&t.addSuffix?t.comparison&&t.comparison>0?"in "+a:a+" ago":a};function N(e){return(n={})=>{const t=n.width?String(n.width):e.defaultWidth;return e.formats[t]||e.formats[e.defaultWidth]}}const oe={full:"EEEE, MMMM do, y",long:"MMMM do, y",medium:"MMM d, y",short:"MM/dd/yyyy"},ie={full:"h:mm:ss a zzzz",long:"h:mm:ss a z",medium:"h:mm:ss a",short:"h:mm a"},ce={full:"{{date}} 'at' {{time}}",long:"{{date}} 'at' {{time}}",medium:"{{date}}, {{time}}",short:"{{date}}, {{time}}"},le={date:N({formats:oe,defaultWidth:"full"}),time:N({formats:ie,defaultWidth:"full"}),dateTime:N({formats:ce,defaultWidth:"full"})},de={lastWeek:"'last' eeee 'at' p",yesterday:"'yesterday at' p",today:"'today at' p",tomorrow:"'tomorrow at' p",nextWeek:"eeee 'at' p",other:"P"},ue=(e,n,t,a)=>de[e];function w(e){return(n,t)=>{const a=t!=null&&t.context?String(t.context):"standalone";let r;if(a==="formatting"&&e.formattingValues){const o=e.defaultFormattingWidth||e.defaultWidth,c=t!=null&&t.width?String(t.width):o;r=e.formattingValues[c]||e.formattingValues[o]}else{const o=e.defaultWidth,c=t!=null&&t.width?String(t.width):e.defaultWidth;r=e.values[c]||e.values[o]}const i=e.argumentCallback?e.argumentCallback(n):n;return r[i]}}const me={narrow:["B","A"],abbreviated:["BC","AD"],wide:["Before Christ","Anno Domini"]},he={narrow:["1","2","3","4"],abbreviated:["Q1","Q2","Q3","Q4"],wide:["1st quarter","2nd quarter","3rd quarter","4th quarter"]},fe={narrow:["J","F","M","A","M","J","J","A","S","O","N","D"],abbreviated:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],wide:["January","February","March","April","May","June","July","August","September","October","November","December"]},ge={narrow:["S","M","T","W","T","F","S"],short:["Su","Mo","Tu","We","Th","Fr","Sa"],abbreviated:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],wide:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"]},be={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"}},ye={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"}},xe=(e,n)=>{const t=Number(e),a=t%100;if(a>20||a<10)switch(a%10){case 1:return t+"st";case 2:return t+"nd";case 3:return t+"rd"}return t+"th"},pe={ordinalNumber:xe,era:w({values:me,defaultWidth:"wide"}),quarter:w({values:he,defaultWidth:"wide",argumentCallback:e=>e-1}),month:w({values:fe,defaultWidth:"wide"}),day:w({values:ge,defaultWidth:"wide"}),dayPeriod:w({values:be,defaultWidth:"wide",formattingValues:ye,defaultFormattingWidth:"wide"})};function v(e){return(n,t={})=>{const a=t.width,r=a&&e.matchPatterns[a]||e.matchPatterns[e.defaultMatchWidth],i=n.match(r);if(!i)return null;const o=i[0],c=a&&e.parsePatterns[a]||e.parsePatterns[e.defaultParseWidth],h=Array.isArray(c)?ve(c,b=>b.test(o)):we(c,b=>b.test(o));let d;d=e.valueCallback?e.valueCallback(h):h,d=t.valueCallback?t.valueCallback(d):d;const y=n.slice(o.length);return{value:d,rest:y}}}function we(e,n){for(const t in e)if(Object.prototype.hasOwnProperty.call(e,t)&&n(e[t]))return t}function ve(e,n){for(let t=0;t<e.length;t++)if(n(e[t]))return t}function De(e){return(n,t={})=>{const a=n.match(e.matchPattern);if(!a)return null;const r=a[0],i=n.match(e.parsePattern);if(!i)return null;let o=e.valueCallback?e.valueCallback(i[0]):i[0];o=t.valueCallback?t.valueCallback(o):o;const c=n.slice(r.length);return{value:o,rest:c}}}const Me=/^(\d+)(th|st|nd|rd)?/i,je=/\d+/i,Pe={narrow:/^(b|a)/i,abbreviated:/^(b\.?\s?c\.?|b\.?\s?c\.?\s?e\.?|a\.?\s?d\.?|c\.?\s?e\.?)/i,wide:/^(before christ|before common era|anno domini|common era)/i},Ne={any:[/^b/i,/^(a|c)/i]},Se={narrow:/^[1234]/i,abbreviated:/^q[1234]/i,wide:/^[1234](th|st|nd|rd)? quarter/i},We={any:[/1/i,/2/i,/3/i,/4/i]},ke={narrow:/^[jfmasond]/i,abbreviated:/^(jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec)/i,wide:/^(january|february|march|april|may|june|july|august|september|october|november|december)/i},Ae={narrow:[/^j/i,/^f/i,/^m/i,/^a/i,/^m/i,/^j/i,/^j/i,/^a/i,/^s/i,/^o/i,/^n/i,/^d/i],any:[/^ja/i,/^f/i,/^mar/i,/^ap/i,/^may/i,/^jun/i,/^jul/i,/^au/i,/^s/i,/^o/i,/^n/i,/^d/i]},Ce={narrow:/^[smtwf]/i,short:/^(su|mo|tu|we|th|fr|sa)/i,abbreviated:/^(sun|mon|tue|wed|thu|fri|sat)/i,wide:/^(sunday|monday|tuesday|wednesday|thursday|friday|saturday)/i},Oe={narrow:[/^s/i,/^m/i,/^t/i,/^w/i,/^t/i,/^f/i,/^s/i],any:[/^su/i,/^m/i,/^tu/i,/^w/i,/^th/i,/^f/i,/^sa/i]},Fe={narrow:/^(a|p|mi|n|(in the|at) (morning|afternoon|evening|night))/i,any:/^([ap]\.?\s?m\.?|midnight|noon|(in the|at) (morning|afternoon|evening|night))/i},Te={any:{am:/^a/i,pm:/^p/i,midnight:/^mi/i,noon:/^no/i,morning:/morning/i,afternoon:/afternoon/i,evening:/evening/i,night:/night/i}},Ee={ordinalNumber:De({matchPattern:Me,parsePattern:je,valueCallback:e=>parseInt(e,10)}),era:v({matchPatterns:Pe,defaultMatchWidth:"wide",parsePatterns:Ne,defaultParseWidth:"any"}),quarter:v({matchPatterns:Se,defaultMatchWidth:"wide",parsePatterns:We,defaultParseWidth:"any",valueCallback:e=>e+1}),month:v({matchPatterns:ke,defaultMatchWidth:"wide",parsePatterns:Ae,defaultParseWidth:"any"}),day:v({matchPatterns:Ce,defaultMatchWidth:"wide",parsePatterns:Oe,defaultParseWidth:"any"}),dayPeriod:v({matchPatterns:Fe,defaultMatchWidth:"any",parsePatterns:Te,defaultParseWidth:"any"})},Ie={code:"en-US",formatDistance:se,formatLong:le,formatRelative:ue,localize:pe,match:Ee,options:{weekStartsOn:0,firstWeekContainsDate:1}};function _e(e,n,t){const r=Q().locale??Ie,i=2520,o=j(e,n);if(isNaN(o))throw new RangeError("Invalid time value");const c=Object.assign({},t,{addSuffix:t==null?void 0:t.addSuffix,comparison:o}),[h,d]=W(t==null?void 0:t.in,...o>0?[n,e]:[e,n]),y=ae(d,h),b=(T(d)-T(h))/1e3,u=Math.round((y-b)/60);let f;if(u<2)return u===0?r.formatDistance("lessThanXMinutes",1,c):r.formatDistance("xMinutes",u,c);if(u<45)return r.formatDistance("xMinutes",u,c);if(u<90)return r.formatDistance("aboutXHours",1,c);if(u<O){const l=Math.round(u/60);return r.formatDistance("aboutXHours",l,c)}else{if(u<i)return r.formatDistance("xDays",1,c);if(u<M){const l=Math.round(u/O);return r.formatDistance("xDays",l,c)}else if(u<M*2)return f=Math.round(u/M),r.formatDistance("aboutXMonths",f,c)}if(f=ne(d,h),f<12){const l=Math.round(u/M);return r.formatDistance("xMonths",l,c)}else{const l=f%12,m=Math.trunc(f/12);return l<3?r.formatDistance("aboutXYears",m,c):l<9?r.formatDistance("overXYears",m,c):r.formatDistance("almostXYears",m+1,c)}}function Re(e,n){return _e(e,U(e),n)}const Le=async()=>{var e,n,t,a,r;try{console.log("Fetching dashboard data...");const i=await E.fetchData({url:"/dashboard",method:"get"});if(console.log("Dashboard response:",i),!((e=i.data)!=null&&e.success)||!i.data.data)throw console.error("Invalid dashboard response:",i),new Error(((n=i.data)==null?void 0:n.message)||"Invalid dashboard data format");const{data:o}=i.data;return{summary:o.summary||{products:0,assigned:0,categories:0,branches:0,employees:0},weeklyTrend:o.weeklyTrend||[],recentActivities:(o.recentActivities||[]).map(c=>({...c,assignedAt:Re(new Date(c.assignedAt))+" ago"})),categoryDistribution:o.categoryDistribution||[]}}catch(i){throw console.error("Detailed dashboard error:",{message:i.message,response:(t=i.response)==null?void 0:t.data,stack:i.stack}),new Error(((r=(a=i.response)==null?void 0:a.data)==null?void 0:r.message)||i.message||"Failed to fetch dashboard data")}},He=()=>{const e=I(),[n,t]=g.useState(null),[a,r]=g.useState(!0),[i,o]=g.useState(null),[c,h]=g.useState(null);if(g.useEffect(()=>{const l=localStorage.getItem("user");if(l)try{h(JSON.parse(l))}catch(m){console.error("Error parsing user data:",m)}},[]),g.useEffect(()=>{(async()=>{try{r(!0);const m=await Le();t(m)}catch(m){const D=(m==null?void 0:m.message)||"Failed to load dashboard data";o(D),console.error("Dashboard Error:",m)}finally{r(!1)}})()},[]),a)return s.jsx("div",{className:"flex justify-center items-center h-full",children:s.jsx(q,{color:"#3b82f6",size:50,speedMultiplier:.8})});if(i||!n)return s.jsx("div",{className:"flex justify-center items-center h-full",children:s.jsx("p",{className:"text-red-500",children:i||"Failed to load dashboard data"})});const{summary:d,weeklyTrend:y,recentActivities:b,categoryDistribution:u}=n,f={series:[{name:"Assignments",data:y.map(l=>l.assignments)}],categories:y.map(l=>l.day)};return s.jsxs("div",{className:"flex flex-col gap-4 h-full p-4",children:[s.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg p-6 shadow-sm",children:[s.jsx("h2",{className:"text-2xl font-bold mb-1",children:"Welcome back"}),s.jsx("p",{className:"text-gray-600 dark:text-gray-300"})]}),s.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-4",children:[s.jsxs(P,{className:"lg:col-span-2",children:[s.jsxs("div",{className:"flex justify-between items-center mb-4",children:[s.jsx("h3",{className:"text-lg font-semibold",children:"Product Overview"}),s.jsxs("div",{className:"flex gap-4",children:[s.jsxs("div",{className:"text-center",children:[s.jsx("div",{className:"text-2xl font-bold",children:d.assigned}),s.jsx("div",{className:"text-sm text-gray-500",children:"Assigned"})]}),s.jsxs("div",{className:"text-center",children:[s.jsx("div",{className:"text-2xl font-bold",children:d.products-d.assigned}),s.jsx("div",{className:"text-sm text-gray-500",children:"Available"})]})]})]}),s.jsx(B,{series:f.series,xAxis:f.categories,height:300,type:"bar",customOptions:{colors:[J[0]],legend:{show:!0,position:"top"}}})]}),s.jsxs(P,{children:[s.jsx("h3",{className:"text-lg font-semibold mb-4",children:"Inventory by Category"}),s.jsx("div",{className:"space-y-4",children:u.map(l=>s.jsxs("div",{children:[s.jsxs("div",{className:"flex justify-between mb-1",children:[s.jsx("span",{className:"font-medium",children:l.name}),s.jsxs("span",{className:"text-sm",children:[l._count.products," items"]})]}),s.jsx(R,{percent:Math.round(l._count.products/d.products*100),className:"h-2",color:"blue-500"})]},l.name))})]})]}),s.jsxs(P,{children:[s.jsxs("div",{className:"flex justify-between items-center mb-4",children:[s.jsx("h3",{className:"text-lg font-semibold",children:"Recent Assignments"}),s.jsx(V,{size:"xs",onClick:()=>e("/assignments"),children:"View All"})]}),s.jsx("div",{className:"space-y-3",children:b.map(l=>s.jsxs("div",{className:"flex items-center justify-between p-3 hover:bg-gray-50 dark:hover:bg-gray-700 rounded-lg",children:[s.jsxs("div",{children:[s.jsx("h4",{className:"font-medium",children:l.product.name}),s.jsxs("p",{className:"text-sm text-gray-500",children:["Assigned to ",l.employee.name," • ",l.assignedAt]})]}),s.jsx(_,{className:"bg-blue-500 text-white",children:"Assigned"})]},l.id))})]})]})};export{He as default};
